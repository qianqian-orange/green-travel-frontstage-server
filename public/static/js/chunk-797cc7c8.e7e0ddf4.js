(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-797cc7c8"],{"0147":function(e,t,a){"use strict";var i=a("ae18"),r=a.n(i);r.a},2532:function(e,t,a){"use strict";var i=a("23e7"),r=a("5a34"),n=a("1d80"),s=a("ab13");i({target:"String",proto:!0,forced:!s("includes")},{includes:function(e){return!!~String(n(this)).indexOf(r(e),arguments.length>1?arguments[1]:void 0)}})},"2d59":function(e,t,a){"use strict";var i=a("a276"),r=a.n(i);r.a},3793:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"public-welfare-add-container"},[a("div",{staticClass:"header"},[a("common-header",{attrs:{to:"/publicWelfare",title:"新增表单"}})],1),a("van-form",{on:{submit:e.submit}},[a("van-field",{attrs:{clearable:"",required:"",label:"标题",rules:e.rules.title},model:{value:e.formData.title,callback:function(t){e.$set(e.formData,"title",t)},expression:"formData.title"}}),a("van-field",{attrs:{clearable:"",required:"",type:"digit",name:"integral",label:"碳积分",rules:e.rules.integral},model:{value:e.formData.integral,callback:function(t){e.$set(e.formData,"integral",t)},expression:"formData.integral"}}),a("van-field",{attrs:{required:"",readonly:"",clickable:"",label:"截止时间",value:e.formData.endTime,rules:e.rules.time},on:{click:function(t){e.showPicker=!0}}}),a("van-popup",{attrs:{position:"bottom"},model:{value:e.showPicker,callback:function(t){e.showPicker=t},expression:"showPicker"}},[a("van-datetime-picker",{attrs:{type:"datetime","min-date":e.minDate},on:{confirm:e.confirm,cancel:function(t){e.showPicker=!1}}})],1),a("van-field",{attrs:{label:"图片",required:"",rules:e.rules.path},scopedSlots:e._u([{key:"input",fn:function(){return[a("van-uploader",{attrs:{"before-read":e.beforeRead,"after-read":e.afterRead,"before-delete":e.beforeDelete,"max-count":1,accept:e.whiteList.join(",")},model:{value:e.list,callback:function(t){e.list=t},expression:"list"}})]},proxy:!0}])}),a("van-field",{attrs:{clearable:"",required:"",rows:"3",autosize:"",label:"描述",type:"textarea",maxlength:"300","show-word-limit":"",rules:e.rules.description},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description",t)},expression:"formData.description"}}),a("div",{staticStyle:{margin:"16px"}},[a("van-button",{attrs:{loading:e.loading,disabled:e.loading,"loading-text":"提交中...",round:"",block:"","native-type":"submit",color:"linear-gradient(to right, #6cd557, #34c2aa)"}},[e._v("提交")])],1)],1)],1)},r=[],n=(a("a4d3"),a("e01a"),a("caad"),a("d3b7"),a("2532"),a("bc3a")),s=a.n(n),o=a("c1df"),l=a.n(o),c=a("c028"),u={name:"PublicWelfareAdd",data:function(){return{whiteList:["image/jpeg","image/jpg","image/png","image/gif"],size:5242880,list:[],loading:!1,minDate:new Date,showPicker:!1,formData:{title:"",integral:"",description:"",path:"1",endTime:""},rules:{title:[{required:!0,message:"请填写标题"}],integral:[{required:!0,message:"请填写碳积分"},{validator:function(e){return e>=1&&e<=1e4},message:"数值不符合要求"}],description:[{required:!0,message:"请填写描述"}],path:[{required:!0,message:"请上传图片"}],time:[{required:!0,message:"请选择截止时间"}]}}},components:{CommonHeader:c["a"]},methods:{submit:function(){var e=this;if(!this.loading){this.loading=!0;var t=this.formData,a=t.path,i=t.endTime,r=t.title,n=t.integral,o=t.description;s.a.post("/api/publicWelfare/save",{title:r,integral:n,description:o,end_time:i,path:a}).then((function(t){var a=t.data.code;0!==a?e.$notify({type:"danger",message:"提交失败！"}):e.$notify({type:"success",message:"提交成功！"})})).finally((function(){e.loading=!1}))}},beforeRead:function(e){var t=e.size,a=e.type;return t>this.size?(this.$toast("图片太大啦！"),!1):!!this.whiteList.includes(a)||(this.$toast("请上传正确的图片格式！"),!1)},afterRead:function(e){var t=this,a=e;a.status="uploading",a.message="上传中...";var i=new FormData;i.append("publicWelfare",a.file),i.append("name","publicWelfare"),s.a.post("http://localhost:3000/api/upload/publicWelfare",i,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){var i=e.data,r=i.code,n=i.path;if(0===r)return a.status="done",a.message="",void(t.formData.path=n);a.status="failed",a.message="上传失败"}))},beforeDelete:function(){return this.path="",!0},confirm:function(e){this.formData.endTime=l()(e).format("YYYY-MM-DD HH:mm"),this.showPicker=!1}}},d=u,f=(a("bf42"),a("0147"),a("2877")),m=Object(f["a"])(d,i,r,!1,null,"6357b56a",null);t["default"]=m.exports},"5a34":function(e,t,a){var i=a("44e7");e.exports=function(e){if(i(e))throw TypeError("The method doesn't accept regular expressions");return e}},"86e5":function(e,t,a){},a276:function(e,t,a){},ab13:function(e,t,a){var i=a("b622"),r=i("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(a){try{return t[r]=!1,"/./"[e](t)}catch(i){}}return!1}},ae18:function(e,t,a){},bf42:function(e,t,a){"use strict";var i=a("86e5"),r=a.n(i);r.a},c028:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"common-header"},[a("router-link",{attrs:{to:e.to}},[a("span",{staticClass:"arrow"})]),a("h1",{staticClass:"title"},[e._v(e._s(e.title))])],1)},r=[],n={name:"CommonHeader",props:{title:{type:String,default:""},to:{type:String,default:"/"}}},s=n,o=(a("2d59"),a("2877")),l=Object(o["a"])(s,i,r,!1,null,"9002ea4a",null);t["a"]=l.exports},caad:function(e,t,a){"use strict";var i=a("23e7"),r=a("4d64").includes,n=a("44d2"),s=a("ae40"),o=s("indexOf",{ACCESSORS:!0,1:0});i({target:"Array",proto:!0,forced:!o},{includes:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),n("includes")}}]);