(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-afac8f24"],{5319:function(t,e,r){"use strict";var i=r("d784"),n=r("825a"),a=r("7b0b"),s=r("50c4"),c=r("a691"),o=r("1d80"),l=r("8aa5"),d=r("14c3"),u=Math.max,f=Math.min,h=Math.floor,p=/\$([$&'`]|\d\d?|<[^>]*>)/g,v=/\$([$&'`]|\d\d?)/g,g=function(t){return void 0===t?t:String(t)};i("replace",2,(function(t,e,r,i){var m=i.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,b=i.REPLACE_KEEPS_$0,y=m?"$":"$0";return[function(r,i){var n=o(this),a=void 0==r?void 0:r[t];return void 0!==a?a.call(r,n,i):e.call(String(n),r,i)},function(t,i){if(!m&&b||"string"===typeof i&&-1===i.indexOf(y)){var a=r(e,t,this,i);if(a.done)return a.value}var o=n(t),h=String(this),p="function"===typeof i;p||(i=String(i));var v=o.global;if(v){var C=o.unicode;o.lastIndex=0}var O=[];while(1){var $=d(o,h);if(null===$)break;if(O.push($),!v)break;var w=String($[0]);""===w&&(o.lastIndex=l(h,s(o.lastIndex),C))}for(var j="",S=0,k=0;k<O.length;k++){$=O[k];for(var E=String($[0]),P=u(f(c($.index),h.length),0),x=[],I=1;I<$.length;I++)x.push(g($[I]));var D=$.groups;if(p){var M=[E].concat(x,P,h);void 0!==D&&M.push(D);var A=String(i.apply(void 0,M))}else A=_(E,h,P,x,D,i);P>=S&&(j+=h.slice(S,P)+A,S=P+E.length)}return j+h.slice(S)}];function _(t,r,i,n,s,c){var o=i+t.length,l=n.length,d=v;return void 0!==s&&(s=a(s),d=p),e.call(c,d,(function(e,a){var c;switch(a.charAt(0)){case"$":return"$";case"&":return t;case"`":return r.slice(0,i);case"'":return r.slice(o);case"<":c=s[a.slice(1,-1)];break;default:var d=+a;if(0===d)return e;if(d>l){var u=h(d/10);return 0===u?e:u<=l?void 0===n[u-1]?a.charAt(1):n[u-1]+a.charAt(1):e}c=n[d-1]}return void 0===c?"":c}))}}))},"65cd":function(t,e,r){"use strict";r.r(e);var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"merchandise-detail-container"},[r("scroll-header",{attrs:{to:"/merchandise",title:"商品详情",visible:t.visible}}),r("scroll-view",{ref:"scroll",attrs:{click:!0,probeType:3},on:{scroll:t.scroll}},[r("div",{staticClass:"scroll-contaienr"},[t.merchandise?r("merchandise-detail-card",{attrs:{merchandise:t.merchandise},on:{conversion:t.toggle}}):t._e(),t.others.length>0?r("div",[r("van-divider",{style:{color:"#222"}},[t._v("看了又看")]),r("div",{staticClass:"list-container"},[r("merchandise-list",{attrs:{list:t.others}})],1)],1):t._e()],1)]),r("van-popup",{staticStyle:{height:"50%","padding-top":"40px"},attrs:{round:"",closeable:"","lock-scroll":!1,position:"bottom"},model:{value:t.popup,callback:function(e){t.popup=e},expression:"popup"}},[r("div",{staticClass:"popup-container"},[r("coupon-list",{on:{use:t.conversion}}),r("div",{staticClass:"btn"},[r("van-button",{attrs:{round:"",block:"",color:"linear-gradient(to right, #6cd557, #34c2aa)"},on:{click:function(e){return t.conversion(-1)}}},[t._v("不使用优惠卷")])],1)],1)])],1)},n=[],a=(r("a4d3"),r("4de4"),r("7db0"),r("4160"),r("a434"),r("e439"),r("dbb4"),r("b64b"),r("d3b7"),r("ac1f"),r("5319"),r("159b"),r("ade3")),s=r("bc3a"),c=r.n(s),o=r("2f62"),l=r("2788"),d=r("b4e2"),u=r("e762"),f=r("0d03"),h=r("9764"),p=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"merchandise-detail-card"},[r("div",{staticClass:"image-container"},[r("van-image",{staticClass:"image",attrs:{src:t.merchandise.path}})],1),r("div",{staticClass:"content-container"},[r("p",{staticClass:"name"},[t._v(t._s(t.merchandise.name))]),r("p",{staticClass:"description"},[t._v(t._s(t.merchandise.description))]),r("div",{staticClass:"integral-container"},[r("div",{staticClass:"integral"},[r("i",{staticClass:"icon icon-tubiao311 iconfont"}),r("span",{staticClass:"pre-integral"},[t._v(t._s(t._f("preIntegral")(t.merchandise.integral)))]),r("span",{staticClass:"last-integral"},[t._v(t._s(t._f("lastIntegral")(t.merchandise.integral)))])]),t.merchandise.stock?r("van-button",{attrs:{type:"primary",size:"small"},on:{click:t.conversion}},[t._v("兑换")]):t._e(),0===t.merchandise.stock?r("van-tag",{attrs:{plain:"",type:"danger"}},[t._v("已售馨")]):t._e()],1)])])},v=[],g=(r("1276"),r("3835")),m={name:"MerchandiseDetailCard",props:{merchandise:{type:Object,required:!0}},filters:{preIntegral:function(t){return parseInt(t,10)},lastIntegral:function(t){var e="".concat(t).split("."),r=Object(g["a"])(e,2),i=r[1];return i?".".concat(i):""}},methods:{conversion:function(){this.$emit("conversion")}}},b=m,y=(r("a284"),r("2877")),_=Object(y["a"])(b,p,v,!1,null,"4c6c3456",null),C=_.exports;function O(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function $(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?O(Object(r),!0).forEach((function(e){Object(a["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var w={name:"MerchandiseDetail",data:function(){return{popup:!1,visible:!1,loading:!1,merchandise:null}},watch:{list:function(){this.$refs.scroll.refresh()},$route:function(t){var e=t.params.id;this.merchandise=this.list.find((function(t){return t.id===+e})),this.$refs.scroll.scrollTo(0,0)}},computed:$({others:function(){var t=this.$route.params.id;return this.list.filter((function(e){return e.id!==+t})).splice(0,5)}},Object(o["c"])("merchandise",{list:function(t){return t.list}}),{},Object(o["c"])("user",{user:function(t){return t}})),components:{MerchandiseList:f["a"],MerchandiseDetailCard:C,ScrollView:d["a"],ScrollHeader:u["a"],CouponList:h["a"]},methods:$({scroll:function(t){var e=t.y;this.visible=e<=-80},toggle:function(){this.popup=!this.popup},conversion:function(t){var e=this;this.toggle(),this.user.integral<this.merchandise.integral?this.$toast({type:"fail",message:"积分不足！"}):this.loading||(this.loading=!0,c.a.post("/api/merchandise/conversion",{id:this.merchandise.id,uc_id:t}).then((function(r){var i=r.data.code;0===i?(e.$notify({type:"success",message:"兑换成功！"}),e[l["d"]]({integral:e.merchandise.integral,id:t}),e.merchandise.stock-=1):e.$notify({type:"danger",message:"兑换失败！"})})).finally((function(){e.loading=!1})))}},Object(o["b"])("user",[l["d"]])),mounted:function(){var t=this,e=this.$route.params.id;this.merchandise=this.list.find((function(t){return t.id===+e})),this.merchandise?this.$refs.scroll.refresh():c.a.get("/api/merchandise/find",{params:{id:+e}}).then((function(e){var r=e.data,i=r.code,n=r.data;if(0===i)return t.merchandise=n,void t.$refs.scroll.refresh();t.$router.replace("/merchandise"),t.$notify({type:"danger",message:"数据请求失败"})}))}},j=w,S=(r("d9a2"),Object(y["a"])(j,i,n,!1,null,"05bc94c6",null));e["default"]=S.exports},"7c5d":function(t,e,r){},a284:function(t,e,r){"use strict";var i=r("7c5d"),n=r.n(i);n.a},d9a2:function(t,e,r){"use strict";var i=r("fe03"),n=r.n(i);n.a},da2e:function(t,e,r){"use strict";var i=r("ff79"),n=r.n(i);n.a},e762:function(t,e,r){"use strict";var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"scroll-header-container"},[r("router-link",{attrs:{to:t.to}},[r("div",{staticClass:"arrow-container"},[r("van-icon",{attrs:{name:"arrow-left"}})],1)]),r("transition",{attrs:{name:"van-fade"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"scroll-header"},[r("router-link",{attrs:{to:t.to}},[r("div",{staticClass:"arrow-container"},[r("van-icon",{attrs:{name:"arrow-left"}})],1)]),r("h2",{staticClass:"title"},[t._v(t._s(t.title))])],1)])],1)},n=[],a={name:"ScrollHeader",props:{to:{type:String,required:!0},title:{type:String,default:""},visible:{type:Boolean,default:!1}}},s=a,c=(r("da2e"),r("2877")),o=Object(c["a"])(s,i,n,!1,null,"58f8a0a4",null);e["a"]=o.exports},fe03:function(t,e,r){},ff79:function(t,e,r){}}]);